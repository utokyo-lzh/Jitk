<!DOCTYPE html>
<html>
<title>Ideas</title>
<xmp theme="united" style="display:none;">

For now, this is a general infrastructure for creating kernel extensions.

* Define a DSL that the kernel accepts; the DSL spec
guarantees safety (e.g., no buffer overflow, no division by zero, or even no loops).

* Implement a compiler that translates a DSL program to machine instructions.

* Prove that the compiler is correct wrt the spec.

It would be great if we can extend this scheme to other kernel
components, such as filesystems, drivers,
and the [security subsystem](http://kernsec.org/wiki/index.php/Projects).

NB: ramfs looks simple, but others may be too complicated..

NB: maybe we should get their specifications first.

NB: compile DSL to CompCert's [RTL](http://compcert.inria.fr/doc/html/RTL.html) for now.
We probably need to prove the RTL program never invokes undefined behavior.

NB: when CompCert doesn't work (e.g., no x86-64 backend), consider to invoke gcc or llvm
for code generation.  We then should at least do translation validation.  That means
we need to convert RTL to LLVM IR.

## Syscall filtering

[seccomp](http://lwn.net/Articles/498231/).
Optmizations across filters may also be interesting (see DPF).

## Packet filtering

[BPF](http://www.tcpdump.org/papers/bpf-usenix93.pdf)
[DPF](http://pdos.csail.mit.edu/~engler/dpf.html)

## Syscall batching

Xen's [multicall](http://lxr.linux.no/linux/arch/x86/xen/multicalls.h).

Linux's
[syslet proposal](http://people.redhat.com/mingo/syslet-patches/patches/async-core-docs.patch)
allows one to abort the execution of multiple syscalls on error,
such as the
[`SYSLET_STOP_ON_NEGATIVE` flag](http://lwn.net/Articles/221913/).

<span style="font-variant: small-caps">CompositeCall</span>:
[Using Interpreted <span style="font-variant: small-caps">CompositeCall</span>s to Improve Operating System Services](http://choices.cs.uiuc.edu/uChoices/Papers/fabio/2k/htdocs/CompositeCall-spe.pdf), from UIUC.
This is an interpreter that supports arithmetic operations and branching.

## Tracing

[ktap](http://www.ktap.org/) uses a bytecode interpreter in kernel.

## UEFI

[EFI byte code virtual machine](http://www.uefi.org/sites/default/files/resources/UEFI_2.4_0.pdf) (page 949)

## General scripting

Lua in [NetBSD](http://www.phoronix.com/scan.php?page=news_item&px=MTQ4ODk).

</xmp>
<script src="assets/strapdown.js"></script>
</html>
